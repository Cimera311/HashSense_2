
<script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/+esm';

    const supabaseUrl = "https://umlgbacgghrvzwfvirro.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVtbGdiYWNnZ2hydnp3ZnZpcnJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY1MTAzMjQsImV4cCI6MjA1MjA4NjMyNH0.Hv0X4Wy4PtbSJ4yEN-CFszdX4zEoW4CMEHrbRBbX1Ug";

    // Supabase-Client erstellen und global verf√ºgbar machen
    window.supabase = createClient(supabaseUrl, supabaseKey);

    // Session abrufen
    const session = JSON.parse(sessionStorage.getItem("supabaseSession"));

    if (session) {
        window.supabase.auth.setSession(session);
        console.log("Supabase-Session in farm2.html geladen:", session);
    } else {
        console.error("Keine Supabase-Session gefunden. Weiterleitung zur Login-Seite...");
        window.location.href = "login.html";
    }
</script>


<div class="main-container">
    <header class="header header-actions">
        <div class="action-center">
            <div class="action-icons">
            <!-- lila Buttons wie "add miner", "save", etc. -->
            <!-- <button class="main-btn" onclick="hinzufuegenCard(get_highest_card(document.querySelector('.content')), '1', '20', '-');">add miner</button>
            <button onclick="speichernDaten()">Save</button>
            <button onclick="ladenDaten()">Load</button>
            <button class="main-btn" onclick="speichernMinerSupabase()">üíæ Save to Cloud</button>
            <button class="main-btn" onclick="ladenMinerSupabase()">‚òÅÔ∏è Load from Cloud</button>
            <button class="main-btn" onclick="loescheMinerSupabase()">üóëÔ∏è Delete from Cloud</button>
            <button class="main-btn" onclick="openImportModal()">Import Miners</button>-->
            <button class="icon-btn" title="Add Miner" onclick="hinzufuegenCard(get_highest_card(document.querySelector('.content')), '1', '20', '-');"><span class="material-icons">add</span></button>
            <button class="icon-btn" title="Save to Cloud" onclick="speichernMinerSupabase()"><span class="material-icons">save</span></button>
            <button class="icon-btn" title="Load from Cloud" onclick="ladenMinerSupabase()"><span class="material-icons">cloud</span></button>
            <button class="icon-btn" title="Delete from Cloud" onclick="loescheMinerSupabase()"><span class="material-icons">delete</span></button>
            <button class="icon-btn import-btn" onclick="openImportModal()">Import Miners</button>
            <button class="icon-btn" onclick="openConvertModal()">Export Transactions</button>


            <!-- Modal f√ºr Miner-Import -->
            <div id="importModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeImportModal()">&times;</span>
                    <button onclick="openHowToImportModal()">How to Import</button>
                    <h2>Miner-Data import</h2>
                    <textarea id="minerInput" rows="10" cols="50" placeholder="Paste miner Data here..."></textarea>
                    <div class="modal-buttons">
                        <button onclick="importMinerData(true)">Replace existing miners</button>
                        <button onclick="importMinerData(false)">Add imported miners</button>
                    </div>
                </div>
            </div>
            <div id="howToImportModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeHowToImportModal()">&times;</span>
                    <h2>How to Import Miners</h2>
                    <p>Step 1: Go to "My Farm" in Gomining.</p>
                    <img src="ClickonUpgrade.jpg" alt="Step 1" style="width: 100%; height: auto; margin: 10px 0; border-radius: 8px;">
                    <p>Step 2: Mark all your miners or those you wanna import.</p>
                    <img src="markallyourminers.jpg" alt="Step 2" style="width: 100%; height: auto; margin: 10px 0; border-radius: 8px;">
                    <p>Step 3: and copy paste them into the import box.</p>
                    <img src="andpastethem.jpg" alt="Step 3" style="width: 100%; height: auto; margin: 10px 0; border-radius: 8px;">
                    <p>after the click on import there will be a windows where you can check them all</p>
                </div>
            </div>
            
            <!-- Kontroll-Modal f√ºr importierte Miner -->
            <div id="previewModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closePreviewModal()">&times;</span>
                    <h2>check imported miners</h2>
                    <div class="table-container">
                        <table id="preview-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Miner Name</th>
                                    <th>TH</th>
                                    <th>W/TH</th>
                                </tr>
                            </thead>
                            <tbody id="preview-tbody"></tbody>
                        </table>
                    </div>
                    <div class="modal-buttons">
                        <button onclick="finalizeImport(true)">Import &  replace</button>
                        <button onclick="finalizeImport(false)">Add miners</button>
                    </div>
                </div>
            </div>
            <div id="convertModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeConvertModal()">&times;</span>
            
                    <div class="button-group">
                        <button class="main-btn" onclick="showTab('transactions-tab')">Transactions</button>
                        <button class="main-btn" onclick="showTab('referral-tab')">Referral</button>
                    </div>
            
                    <div class="tab-page active" id="transactions-tab">
                        <h2>Transactions Export</h2>
                        <textarea id="transactionInput" rows="15" style="width:90%;" placeholder="Paste your transaction history here..."></textarea>
                        <div class="single-button-container" style="margin-top: 10px;">
                        <button class="main-btn" onclick="convertTransactionsToXLSX()">Download Your XLSX</button>
                        <button  class="main-btn" onclick="clearTransactionInput()">Clear</button>
                        </div>
                        <div id="messageBox" style="margin-top: 20px; padding: 10px; background-color: #2a2a2a; color: #00ff7f; border-radius: 5px; display: none;"></div>
                    </div>
            
                    <div class="tab-page" id="referral-tab" style="display:none;">
                        <h2>Referral Export</h2>
                        <textarea id="referralInput" rows="15" style="width:90%;" placeholder="Paste your referral data here..."></textarea>
                        <div class="single-button-container">
                        <button class="main-btn" onclick="convertReferralToCSV()">Download Referral CSV</button>
                        </div>
                    </div>
            
                </div>
            </div>
            
            </div>
        </div>
            <div class="action-footer spaced">

                <div class="view-toggle">
                    <button class="toggle-btn active" id="grid-btn" onclick="wechselAnsicht('grid')">grid</button>
                    <button class="toggle-btn" id="list-btn" onclick="wechselAnsicht('list')">list</button>
                    </div>                          


                <div class="currency-toggle">
                    <button class="toggle-btn active" id="btc-btn" onclick="wechselWaehrung('btc')">BTC</button>
                    <button class="toggle-btn" id="usd-btn" onclick="wechselWaehrung('usd')">USD</button>
                    <button class="toggle-btn" id="gmt-btn" onclick="wechselWaehrung('gmt')">GMT</button>
                    </div>  
        </div>


        <span id="currencyMode" style="display: none;">usd</span>
        <span id="viewMode" style="display: none;">grid</span>

    </header>
</div>
<div class="main-container">

<div class="content" id="farm-content">

</div>

        <div class="content" id="content"></div>
        <footer class="footer">
            <h3 style="color: #673dec;">Support Us</h3>
            <p>If you like our work, feel free to support us by sending GMT tokens on BNB Smart Chain:</p>
            <div class="wallet-address-container">
                <img class="wallet-icon" src="https://github.com/Cimera311/Gomining_Calculator/raw/main/GoMining_Logo.webp" alt="Wallet Icon">
                <span class="wallet-address">0x3229E3118F803d8EaCB52D5f598395F5bf888bad</span>

            </div>
            <div class="single-button-container">
            <button onclick="copyToClipboard('0x3229E3118F803d8EaCB52D5f598395F5bf888bad')" style="background-color: #673dec; color: white; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer;">Copy adress</button>        
            </div>

            <p>Or join us through our referral link:</p>
            <a href="https://gomining.com/?ref=ICjK3" target="_blank" style="display: inline-block; margin: 10px;">
                <img src="https://cimera311.github.io/Gomining_Calculator/Gomining.jpg" alt="GoMining Referral" style="width: 150px; height: auto; border-radius: 5px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
            </a>
            <a href="https://app.gomining.com/miner-wars/mining/select-pool?inviteToClan=2232" target="_blank" style="width: 150px; height: auto; border-radius: 5px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
                <img id="bottom-image" src="IMG_5594.jpeg" alt="Join Us!!!" style="width: 150px; height: auto; border-radius: 5px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
            </a>
            <p>&copy; 2024 HashSense. All rights reserved.</p>
            <p>This website is for informational purposes only.</p>
        </footer>

</div>


    

    



